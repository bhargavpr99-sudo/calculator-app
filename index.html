<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculator</title>
  <style>
    body { font-family: Arial; background: #f4f4f4; display:flex; justify-content:center; padding-top:40px; }
    .calc { width: 260px; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px #999; }
    .display { background:#222; color:white; padding:15px; font-size:24px; text-align:right; border-radius:6px; margin-bottom:10px; }
    .grid { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; }
    button { padding:15px; font-size:18px; cursor:pointer; border-radius:6px; border:none; background:#eee; }
    button.operator { background:#007bff; color:white; }
    button.equal { grid-column:span 2; background:#28a745; color:white; }
  </style>
</head>

<body>

  <div class="calc">
    <div id="display" class="display">0</div>

    <div class="grid">
      <button data-action="clear">C</button>
      <button data-action="neg">+/-</button>
      <button data-action="percent">%</button>
      <button class="operator" data-value="/">÷</button>

      <button data-value="7">7</button>
      <button data-value="8">8</button>
      <button data-value="9">9</button>
      <button class="operator" data-value="*">×</button>

      <button data-value="4">4</button>
      <button data-value="5">5</button>
      <button data-value="6">6</button>
      <button class="operator" data-value="-">−</button>

      <button data-value="1">1</button>
      <button data-value="2">2</button>
      <button data-value="3">3</button>
      <button class="operator" data-value="+">+</button>

      <button data-value="0">0</button>
      <button data-value=".">.</button>
      <button class="equal" data-action="equals">=</button>
    </div>
  </div>

  <script>
    (function () {
      const display = document.getElementById("display");
      let expr = "";
      let lastWasEq = false;

      function update() {
        if (!expr) {
          display.textContent = "0";
          return;
        }
        try {
          const safe = expr.replace(/[^0-9+\-*/.%() ]/g, "");
          const value = eval(safe);
          display.textContent = value !== undefined ? value : "0";
        } catch {
          display.textContent = "Error";
        }
      }

      function push(val) {
        if (lastWasEq && /[0-9.]/.test(val)) {
          expr = "";
          lastWasEq = false;
        }
        expr += val;
        update();
      }

      function action(type) {
        if (type === "clear") {
          expr = "";
          update();
          return;
        }

        if (type === "equals") {
          try {
            const safe = expr.replace(/[^0-9+\-*/.%() ]/g, "");
            expr = String(eval(safe));
          } catch {
            expr = "";
            display.textContent = "Error";
          }
          lastWasEq = true;
          update();
          return;
        }

        if (type === "neg") {
          expr = expr.replace(/(\d+\.?\d*)$/, m => m.startsWith("-") ? m.slice(1) : "-" + m);
          update();
          return;
        }

        if (type === "percent") {
          expr = expr.replace(/(\d+\.?\d*)$/, m => String(parseFloat(m) / 100));
          update();
          return;
        }
      }

      document.querySelectorAll("button").forEach(btn => {
        const val = btn.dataset.value;
        const a = btn.dataset.action;

        btn.addEventListener("click", () => {
          if (a) action(a);
          else push(val);
        });
      });

      window.addEventListener("keydown", e => {
        if (e.key === "Enter") { action("equals"); return; }
        if (e.key === "Backspace") { expr = expr.slice(0, -1); update(); return; }
        if (/[0-9.+\-*/()%]/.test(e.key)) { push(e.key); }
      });

      update();
    })();
  </script>

</body>
</html>

